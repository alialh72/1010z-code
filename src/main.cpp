// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Inertial2            inertial      14              
// Controller1          controller                    
// LeftDrive            motor_group   8, 19           
// LeftTop              motor         7               
// RightDrive           motor_group   4, 5            
// RightTop             motor         20              
// MagazinePiston       digital_out   C               
// EncoderHorz          encoder       E, F            
// EncoderPara          encoder       G, H            
// FlyWheel             motor         2               
// Intake               motor         11              
// EndgamePiston        digital_out   A               
// BlooperPiston        digital_out   D               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Inertial2            inertial      14              
// Controller1          controller                    
// LeftDrive            motor_group   8, 19           
// LeftTop              motor         7               
// RightDrive           motor_group   4, 5            
// RightTop             motor         20              
// MagazinePiston       digital_out   C               
// EncoderHorz          encoder       E, F            
// EncoderPara          encoder       G, H            
// FlyWheel             motor         2               
// Intake               motor         11              
// EndgamePiston        digital_out   A               
// Blooper              digital_out   D               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Inertial2            inertial      14              
// Controller1          controller                    
// LeftDrive            motor_group   8, 19           
// LeftTop              motor         7               
// RightDrive           motor_group   4, 5            
// RightTop             motor         20              
// MagazinePiston       digital_out   C               
// EncoderHorz          encoder       E, F            
// EncoderPara          encoder       G, H            
// FlyWheel             motor         2               
// Intake               motor         11              
// EndgamePiston        digital_out   A               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Inertial2            inertial      14              
// Controller1          controller                    
// LeftDrive            motor_group   8, 19           
// LeftTop              motor         7               
// RightDrive           motor_group   4, 5            
// RightTop             motor         20              
// MagazinePiston       digital_out   C               
// EncoderHorz          encoder       E, F            
// EncoderPara          encoder       G, H            
// FlyWheel             motor         2               
// Intake               motor         11              
// EndgamePiston        digital_out   A               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Inertial2            inertial      14              
// Controller1          controller                    
// LeftDrive            motor_group   8, 19           
// LeftTop              motor         7               
// RightDrive           motor_group   4, 5            
// RightTop             motor         20              
// MagazinePiston       digital_out   B               
// EncoderHorz          encoder       E, F            
// EncoderPara          encoder       G, H            
// FlyWheel             motor         2               
// Intake               motor         11              
// EndgamePiston        digital_out   A               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Inertial2            inertial      14              
// Controller1          controller                    
// LeftDrive            motor_group   8, 19           
// LeftTop              motor         7               
// RightDrive           motor_group   4, 5            
// RightTop             motor         20              
// MagazinePiston       digital_out   B               
// EncoderHorz          encoder       C, D            
// EncoderPara          encoder       G, H            
// FlyWheel             motor         2               
// Intake               motor         11              
// EndgamePiston        digital_out   A               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Inertial2            inertial      14              
// Controller1          controller                    
// LeftDrive            motor_group   8, 19           
// LeftTop              motor         7               
// RightDrive           motor_group   4, 5            
// RightTop             motor         20              
// MagazinePiston       digital_out   F               
// EncoderHorz          encoder       C, D            
// EncoderPara          encoder       G, H            
// FlyWheel             motor         2               
// Intake               motor         11              
// EndgamePiston        digital_out   A               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Inertial2            inertial      14              
// Controller1          controller                    
// LeftDrive            motor_group   8, 19           
// LeftTop              motor         7               
// RightDrive           motor_group   4, 5            
// RightTop             motor         20              
// MagazinePiston       digital_out   F               
// EncoderHorz          encoder       C, D            
// EncoderPara          encoder       G, H            
// FlyWheel             motor         2               
// Intake               motor         11              
// EndgamePiston        digital_out   B               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Inertial2            inertial      14              
// Controller1          controller                    
// LeftDrive            motor_group   8, 19           
// LeftTop              motor         7               
// RightDrive           motor_group   4, 5            
// RightTop             motor         20              
// MagazinePiston       digital_out   A               
// EncoderHorz          encoder       C, D            
// EncoderPara          encoder       G, H            
// FlyWheel             motor         2               
// Intake               motor         11              
// EndgamePiston        digital_out   B               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Inertial2            inertial      14              
// Controller1          controller                    
// LeftDrive            motor_group   8, 19           
// LeftTop              motor         7               
// RightDrive           motor_group   4, 5            
// RightTop             motor         20              
// MagazinePiston       digital_out   A               
// EncoderHorz          encoder       C, D            
// EncoderPara          encoder       G, H            
// FlyWheel             motor         3               
// Intake               motor         11              
// EndgamePiston        digital_out   B               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Inertial2            inertial      14              
// Controller1          controller                    
// LeftDrive            motor_group   8, 19           
// LeftTop              motor         7               
// RightDrive           motor_group   4, 5            
// RightTop             motor         20              
// MagazinePiston       digital_out   A               
// EncoderHorz          encoder       C, D            
// EncoderPara          encoder       G, H            
// FlyWheel             motor         3               
// Intake               motor         11              
// EndgamePiston        digital_out   B               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Inertial2            inertial      14              
// Controller1          controller                    
// LeftDrive            motor_group   8, 19           
// LeftTop              motor         7               
// RightDrive           motor_group   4, 5            
// RightTop             motor         10              
// MagazinePiston       digital_out   A               
// EncoderHorz          encoder       C, D            
// EncoderPara          encoder       G, H            
// FlyWheel             motor         3               
// Intake               motor         11              
// EndgamePiston        digital_out   B               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Inertial2            inertial      14              
// Controller1          controller                    
// LeftDrive            motor_group   8, 2            
// LeftTop              motor         7               
// RightDrive           motor_group   4, 5            
// RightTop             motor         10              
// MagazinePiston       digital_out   A               
// EncoderHorz          encoder       C, D            
// EncoderPara          encoder       G, H            
// FlyWheel             motor         3               
// Intake               motor         11              
// EndgamePiston        digital_out   B               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Inertial2            inertial      14              
// Controller1          controller                    
// LeftDrive            motor_group   8, 2            
// LeftTop              motor         7               
// RightDrive           motor_group   4, 6            
// RightTop             motor         10              
// MagazinePiston       digital_out   A               
// EncoderHorz          encoder       C, D            
// EncoderPara          encoder       G, H            
// FlyWheel             motor         3               
// Intake               motor         11              
// EndgamePiston        digital_out   B               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Inertial2            inertial      5               
// Controller1          controller                    
// LeftDrive            motor_group   8, 2            
// LeftTop              motor         7               
// RightDrive           motor_group   4, 6            
// RightTop             motor         10              
// MagazinePiston       digital_out   A               
// EncoderHorz          encoder       C, D            
// EncoderPara          encoder       G, H            
// FlyWheel             motor         3               
// Intake               motor         11              
// EndgamePiston        digital_out   B               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Inertial2            inertial      5               
// Controller1          controller                    
// LeftDrive            motor_group   8, 2            
// LeftTop              motor         7               
// RightDrive           motor_group   9, 6            
// RightTop             motor         10              
// MagazinePiston       digital_out   A               
// EncoderHorz          encoder       C, D            
// EncoderPara          encoder       G, H            
// FlyWheel             motor         3               
// Intake               motor         11              
// EndgamePiston        digital_out   B               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Inertial2            inertial      5               
// Controller1          controller                    
// LeftDrive            motor_group   8, 2            
// LeftTop              motor         7               
// RightDrive           motor_group   9, 6            
// RightTop             motor         10              
// MagazinePiston       digital_out   A               
// EncoderHorz          encoder       C, D            
// EncoderPara          encoder       G, H            
// FlyWheel             motor         3               
// Intake               motor         11              
// EndgamePiston        digital_out   B               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Inertial2            inertial      5               
// Controller1          controller                    
// LeftDrive            motor_group   4, 2            
// LeftTop              motor         7               
// RightDrive           motor_group   9, 6            
// RightTop             motor         10              
// MagazinePiston       digital_out   A               
// EncoderHorz          encoder       C, D            
// EncoderPara          encoder       G, H            
// FlyWheel             motor         3               
// Intake               motor         11              
// EndgamePiston        digital_out   B               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Inertial2            inertial      5               
// Controller1          controller                    
// LeftDrive            motor_group   4, 2            
// LeftTop              motor         7               
// RightDrive           motor_group   9, 8            
// RightTop             motor         10              
// MagazinePiston       digital_out   A               
// EncoderHorz          encoder       C, D            
// EncoderPara          encoder       G, H            
// FlyWheel             motor         3               
// Intake               motor         11              
// EndgamePiston        digital_out   B               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// Inertial2            inertial      5               
// Controller1          controller                    
// LeftDrive            motor_group   4, 2            
// LeftTop              motor         7               
// RightDrive           motor_group   9, 8            
// RightTop             motor         10              
// MagazinePiston       digital_out   A               
// EncoderHorz          encoder       C, D            
// EncoderPara          encoder       G, H            
// FlyWheel             motor         3               
// Intake               motor         6               
// EndgamePiston        digital_out   B               
// ---- END VEXCODE CONFIGURED DEVICES ----
#include "main.h"
#include <fstream>
#include <string>
#include <cstring>



using namespace vex;

competition Competition;


void pre_auton(void) {
  vexcodeInit();

  std::vector<Point> list;

  // Create a text string, which is used to output the text file
  std::string myText;

  // Read from the text file
  std::ifstream file("pure.txt");

  // Use a while loop together with the getline() function to read the file line by line
  while (std::getline(file, myText)){
    Point one = parseString(myText);

    list.push_back(one);
  }

  // Close the file
  file.close();


 
}


int autonToRun = 4;

void autonomous(void) {
  if(autonToRun == 0) {
    LeftAuto();
  } else if (autonToRun == 1) {
    LeftAWP();
  } else if(autonToRun==2) {
    RightAuto();
  } else if(autonToRun==3) {
    SkillsAuto();
  }else if(autonToRun==4) {
    BetterRightAuto();
  }
  else if(autonToRun==5) {
    Left();
  }

}


void initUserControl() {
  vex::controller Controller1 (vex::controllerType::primary);
  vex::controller Controller2 (vex::controllerType::partner);

  //---------------Settings--------------- 
  
  LeftDrive.setStopping(hold);
  LeftTop.setStopping(hold);
  RightDrive.setStopping(hold);
  RightTop.setStopping(hold);

  SetFlyWheelPower(9.5);
}



void usercontrol(void) {

  vex::task runFlywheel(FlyWheelThread);
  vex::task runIntake(IntakeThread);

  enableOdom = true;
  vex::task odomThread(OdomThread);
  vex::task BrainPrint(brainPrint);


  Controller1.ButtonA.pressed(FlyWheelSwap);

  Controller1.ButtonR1.pressed(IntakeSwap);
  Controller1.ButtonR1.pressed(IntakeEngaged);
  Controller1.ButtonR2.pressed(ShooterSwap);


  limiter rpmlimit;
  initUserControl();

  Controller1.ButtonL1.pressed(ShootEngaged);
  Controller1.ButtonL2.pressed(StopAll);
  Controller1.ButtonRight.pressed(EndgameFire);

  Controller1.ButtonY.pressed(BlooperToggle);
  Controller1.ButtonX.pressed(FlyWheelIncrease);
  Controller1.ButtonB.pressed(FlyWheelDecrease);


  while (1) {

    //---------------Drivetrain---------------
    float fwdVal = Controller1.Axis3.position(percent);
    float turnVal = Controller1.Axis1.position(percent);

    //Volts Range:  -12 --> 12
    float turnRPM = turnVal * 0.12; //convert percentage to volts
    float fwdRPM = fwdVal * 0.12 * (1 - (std::abs(turnRPM/12) * turnImportance)); 
    fwdRPM = rpmlimit.rateLimiter(fwdRPM, 65);

    SpinDrive(fwdRPM - turnRPM, fwdRPM + turnRPM);

    wait(20, msec); 


  }
}





class Button
{
  public:
    int x, y, width, height;
    std::string text;
    vex::color buttonColor, textColor;
    
    Button(int x, int y, int width, int height, std::string text, vex::color buttonColor, vex::color textColor)
    : x(x), y(y), width(width), height(height), text(text), buttonColor(buttonColor), textColor(textColor){}

    void render()
    {
      Brain.Screen.drawRectangle(x, y, width, height, buttonColor);
      Brain.Screen.printAt(x + 10, y + 10, false, text.c_str());
    }

    bool isClicked()
    {
      if(Brain.Screen.pressing() && Brain.Screen.xPosition() >= x && Brain.Screen.xPosition() <= x + width &&
      Brain.Screen.yPosition() >= y && Brain.Screen.yPosition() <= y + width) return true;
      return false;
    }
};

Button autonButtons[] = {
  Button(10, 10, 150, 50, "Auton Red 1", vex::green, vex::black),
  Button(170, 10, 150, 50, "Auton Red 2", vex::white, vex::black),
  Button(10, 70, 150, 50, "Auton Blue 1", vex::white, vex::black),
  Button(170, 70, 150, 50, "Auton Blue 2", vex::white, vex::black)
};



//
// Main will set up the competition functions and callbacks.
//
int main() {
  // Set up callbacks for autonomous and driver control periods.
  Competition.autonomous(autonomous);
  Competition.drivercontrol(usercontrol);

  // Run the pre-autonomous function.
  pre_auton();

  // Prevent main from exiting with an infinite loop.
  while (true) {
    wait(100, msec);
  }
}
